<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìˆ˜ìˆ ì‹¤ - ìµœì¢… ì„ íƒ</title>
  <link rel="stylesheet" href="../style.css" />
  <script src="../inventory.js"></script>
  <script src="../journal.js"></script>
</head>
<body>
  <div class="game-layout">
    <!-- ì™¼ìª½ ê²Œì„ ì˜ì—­ -->
    <div class="game-area">
      <!-- ê·¸ë¦¼ ì˜ì—­ -->
      <div class="image-area">
        <img src="../IMG/ìˆ˜ìˆ ì‹¤.png" alt="ìˆ˜ìˆ ì‹¤" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;">
      </div>

      <!-- ê²Œì„ ì»¨í…Œì´ë„ˆ -->
      <div id="game-container">
        <div id="scene-text">
          ëª¨ë“  ê¸°ì–µì´ ì„ ëª…í•´ì¡ŒìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ ì´ì œ ìì‹ ì´ ëˆ„êµ¬ì¸ì§€, ë¬´ì—‡ì„ í•´ì•¼ í•˜ëŠ”ì§€ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. 
          ì´ê³³ì—ì„œ ìµœì¢…ì ì¸ ì„ íƒì„ í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ìš´ëª…ì´ ê²°ì •ë˜ëŠ” ìˆœê°„ì…ë‹ˆë‹¤.
        </div>
        
        <div class="choice-section">
          <h3 style="color: #4a9eff; margin-bottom: 25px; text-align: center;">ğŸ¯ ìš´ëª…ì˜ ì„ íƒ</h3>
          <p style="margin-bottom: 30px; color: #e8f4fd; text-align: center; line-height: 1.6;">
            ê³¼ê±°ì˜ ê¸°ì–µê³¼ í˜„ì¬ì˜ ìƒí™©ì„ ê³ ë ¤í•˜ì—¬, ë‹¹ì‹ ë§Œì˜ ê²°ë‹¨ì„ ë‚´ë¦¬ì„¸ìš”.
          </p>
          
          <div id="options" class="choice-buttons">
            <button onclick="chooseEnding('accept')" class="game-button primary accept">
              <span class="button-icon">âœ…</span>
              <span class="button-text">ê¸°ì–µ ë°›ì•„ë“¤ì´ê³  íƒˆì¶œí•œë‹¤</span>
            </button>
            <button onclick="chooseEnding('reject')" class="game-button secondary reject">
              <span class="button-icon">âŒ</span>
              <span class="button-text">ê¸°ì–µì„ ë²„ë¦¬ê³  ì‹¤í—˜ì²´ë¡œ ë‚¨ëŠ”ë‹¤</span>
            </button>
            <button id="revenge-button" onclick="chooseEnding('revenge')" class="game-button primary revenge" style="display: none;">
              <span class="button-icon">âš”ï¸</span>
              <span class="button-text">ì‹¤í—˜ìë¥¼ ì œê±°í•˜ê³  ë³µìˆ˜í•œë‹¤</span>
            </button>
          </div>

          <!-- ì§„ì—”ë”© íŒíŠ¸ -->
          <div id="revenge-hint" class="revenge-hint" style="display: none;">
            <div class="hint-box">
              <h4 style="color: #f44336; margin-bottom: 15px;">ğŸ”’ ë³µìˆ˜ ì—”ë”© ì ê¸ˆ í•´ì œ</h4>
              <p style="color: #e8f4fd; line-height: 1.6; margin-bottom: 15px;">
                ë³µìˆ˜ ì—”ë”©ì„ ì„ íƒí•˜ë ¤ë©´ <strong>"ì‹¤í—˜ìì˜ ì—´ì‡ "</strong>ê°€ í•„ìš”í•©ë‹ˆë‹¤.
                ì´ ì—´ì‡ ëŠ” ì‹¤í—˜ìë“¤ì´ ì‚¬ìš©í•˜ëŠ” íŠ¹ë³„í•œ ì—´ì‡ ë¡œ, 
                ì‹¤í—˜ ì‹œì„¤ì˜ ëª¨ë“  ë¬¸ì„ ì—´ ìˆ˜ ìˆëŠ” ë§ˆìŠ¤í„° í‚¤ì…ë‹ˆë‹¤.
              </p>
              <p style="color: #ffc107; font-weight: 600;">
                ğŸ’¡ íŒíŠ¸: ì´ì „ ë°©ë“¤ì—ì„œ ì‹¤í—˜ìë“¤ì´ ë‚¨ê²¨ë‘” ë‹¨ì„œë¥¼ ì°¾ì•„ë³´ì„¸ìš”.
              </p>
            </div>
          </div>
        </div>

        <div id="message" class="message-display"></div>
      </div>
    </div>

    <!-- ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°” -->
    <div class="sidebar">
      <!-- ì¸ë²¤í† ë¦¬ì™€ ì¼ì§€ê°€ ì—¬ê¸°ì— ìë™ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
    </div>
  </div>

  <style>
    .choice-section {
      background: linear-gradient(145deg, rgba(26, 26, 46, 0.9) 0%, rgba(22, 33, 62, 0.9) 100%);
      border: 2px solid rgba(74, 158, 255, 0.4);
      border-radius: 20px;
      padding: 30px;
      margin: 20px 0;
      backdrop-filter: blur(15px);
    }

    .choice-buttons {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .game-button {
      display: flex;
      align-items: center;
      gap: 15px;
      background: linear-gradient(135deg, rgba(74, 158, 255, 0.2) 0%, rgba(41, 128, 185, 0.2) 100%);
      border: 2px solid rgba(74, 158, 255, 0.4);
      border-radius: 15px;
      padding: 20px 25px;
      color: #e8f4fd;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      text-align: left;
      width: 100%;
    }

    .game-button:hover {
      background: linear-gradient(135deg, rgba(74, 158, 255, 0.3) 0%, rgba(41, 128, 185, 0.3) 100%);
      border-color: rgba(74, 158, 255, 0.6);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(74, 158, 255, 0.4);
    }

    .game-button.primary {
      background: linear-gradient(135deg, #4a9eff 0%, #2980b9 100%);
      border-color: #4a9eff;
      color: white;
      text-align: center;
      justify-content: center;
    }

    .game-button.primary:hover {
      background: linear-gradient(135deg, #5ba9ff 0%, #3a90ca 100%);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(74, 158, 255, 0.5);
    }

    .game-button.secondary {
      background: linear-gradient(135deg, rgba(108, 117, 125, 0.2) 0%, rgba(73, 80, 87, 0.2) 100%);
      border-color: rgba(108, 117, 125, 0.4);
    }

    .game-button.secondary:hover {
      background: linear-gradient(135deg, rgba(108, 117, 125, 0.3) 0%, rgba(73, 80, 87, 0.3) 100%);
      border-color: rgba(108, 117, 125, 0.6);
    }

    .game-button.accept {
      background: linear-gradient(135deg, #4CAF50 0%, #388E3C 100%);
      border-color: #4CAF50;
    }

    .game-button.accept:hover {
      background: linear-gradient(135deg, #66BB6A 0%, #4CAF50 100%);
      box-shadow: 0 8px 25px rgba(76, 175, 80, 0.5);
    }

    .game-button.reject {
      background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
      border-color: #FF9800;
    }

    .game-button.reject:hover {
      background: linear-gradient(135deg, #FFB74D 0%, #FF9800 100%);
      box-shadow: 0 8px 25px rgba(255, 152, 0, 0.5);
    }

    .game-button.revenge {
      background: linear-gradient(135deg, #F44336 0%, #D32F2F 100%);
      border-color: #F44336;
    }

    .game-button.revenge:hover {
      background: linear-gradient(135deg, #EF5350 0%, #F44336 100%);
      box-shadow: 0 8px 25px rgba(244, 67, 54, 0.5);
    }

    .game-button.locked {
      background: linear-gradient(135deg, rgba(108, 117, 125, 0.3) 0%, rgba(73, 80, 87, 0.3) 100%);
      border-color: rgba(108, 117, 125, 0.6);
      color: rgba(232, 244, 253, 0.6);
      cursor: not-allowed;
    }

    .game-button.locked:hover {
      transform: none;
      box-shadow: none;
    }

    .button-icon {
      font-size: 20px;
      min-width: 28px;
    }

    .button-text {
      flex: 1;
      font-size: 16px;
    }

    .revenge-hint {
      margin-top: 20px;
      text-align: center;
    }

    .hint-box {
      background: linear-gradient(135deg, rgba(244, 67, 54, 0.1) 0%, rgba(211, 47, 47, 0.1) 100%);
      border: 2px solid rgba(244, 67, 54, 0.3);
      border-radius: 15px;
      padding: 20px;
      backdrop-filter: blur(10px);
    }

    .message-display {
      background: linear-gradient(135deg, rgba(74, 158, 255, 0.1) 0%, rgba(41, 128, 185, 0.1) 100%);
      border: 1px solid rgba(74, 158, 255, 0.3);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
      text-align: center;
      color: #4a9eff;
      font-weight: 600;
      min-height: 20px;
      backdrop-filter: blur(10px);
      font-size: 18px;
      line-height: 1.6;
    }

    #scene-text {
      background: linear-gradient(135deg, rgba(74, 158, 255, 0.1) 0%, rgba(41, 128, 185, 0.1) 100%);
      border: 1px solid rgba(74, 158, 255, 0.3);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
      color: #e8f4fd;
      font-size: 16px;
      line-height: 1.6;
      backdrop-filter: blur(10px);
    }

    .ending-message {
      animation: fadeInUp 0.8s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>

  <script>
    const endingMessage = document.getElementById('message');
    const revengeButton = document.getElementById('revenge-button');
    const revengeHint = document.getElementById('revenge-hint');

    function checkRevengeAvailability() {
      // ì‹¤í—˜ìì˜ ì—´ì‡ ê°€ ìˆëŠ”ì§€ í™•ì¸
      if (hasInImportantInventory('ì‹¤í—˜ìì˜ ì—´ì‡ ')) {
        revengeButton.style.display = 'flex';
        revengeHint.style.display = 'none';
        addJournalEntry('ì‹¤í—˜ìì˜ ì—´ì‡ ë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì´ì œ ë³µìˆ˜ì˜ ê¸¸ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'clue');
      } else {
        revengeButton.style.display = 'none';
        revengeHint.style.display = 'block';
        addJournalEntry('ë³µìˆ˜ ì—”ë”©ì„ ì„ íƒí•˜ë ¤ë©´ ì‹¤í—˜ìì˜ ì—´ì‡ ê°€ í•„ìš”í•©ë‹ˆë‹¤.', 'observation');
      }
    }

    function chooseEnding(choice) {
      // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
      const buttons = document.querySelectorAll('.game-button');
      buttons.forEach(btn => {
        btn.disabled = true;
        btn.style.opacity = '0.6';
        btn.style.cursor = 'default';
      });

      let message = '';
      let journalEntry = '';

      switch(choice) {
        case 'accept':
          message = "ğŸ‰ ë‹¹ì‹ ì€ ëª¨ë“  ê²ƒì„ ë°›ì•„ë“¤ì´ê³  ììœ ë¥¼ ë˜ì°¾ì•˜ìŠµë‹ˆë‹¤. ê³¼ê±°ì˜ ìƒì²˜ë¥¼ ì¹˜ìœ í•˜ë©° ìƒˆë¡œìš´ ì‚¶ì„ ì‹œì‘í•  ê²ƒì…ë‹ˆë‹¤. í•´í”¼ ì—”ë”©ì…ë‹ˆë‹¤.";
          journalEntry = 'ê¸°ì–µì„ ë°›ì•„ë“¤ì´ê³  íƒˆì¶œì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ììœ ë¥¼ ë˜ì°¾ì•˜ìŠµë‹ˆë‹¤.';
          break;

        case 'reject':
          message = "ğŸ˜” ë‹¹ì‹ ì€ ê¸°ì–µì„ ê±°ë¶€í•˜ê³  ì‹¤í—˜ì²´ë¡œ ë‚¨ì•˜ìŠµë‹ˆë‹¤. ë¬´ì§€í•œ ìƒíƒœë¡œ ì‹¤í—˜ìë“¤ì˜ ì§€ë°°ë¥¼ ë°›ê²Œ ë©ë‹ˆë‹¤. ë°°ë“œ ì—”ë”©ì…ë‹ˆë‹¤.";
          journalEntry = 'ê¸°ì–µì„ ê±°ë¶€í•˜ê³  ì‹¤í—˜ì²´ë¡œ ë‚¨ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.';
          break;

        case 'revenge':
          if (hasInImportantInventory('ì‹¤í—˜ìì˜ ì—´ì‡ ')) {
            message = "âš”ï¸ ë³µìˆ˜ë¥¼ ê²°ì‹¬í–ˆìŠµë‹ˆë‹¤. ì‹¤í—˜ìë“¤ì—ê²Œ ê°€í•´ì§„ ê³ í†µì„ ë˜ê°šì•„ì£¼ê² ìŠµë‹ˆë‹¤. ì§„ì •í•œ ëì´ ì‹œì‘ë©ë‹ˆë‹¤...";
            journalEntry = 'ë³µìˆ˜ë¥¼ ê²°ì‹¬í–ˆìŠµë‹ˆë‹¤. ì‹¤í—˜ìë“¤ì—ê²Œ ë˜ê°šì•„ì£¼ê² ìŠµë‹ˆë‹¤.';
          } else {
            message = "âŒ ì‹¤í—˜ìì˜ ì—´ì‡ ê°€ ì—†ì–´ ë³µìˆ˜ë¥¼ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
            journalEntry = 'ì‹¤í—˜ìì˜ ì—´ì‡ ê°€ ì—†ì–´ ë³µìˆ˜ë¥¼ ì„ íƒí•  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤.';
            return;
          }
          break;
      }

      endingMessage.innerHTML = `<div class="ending-message">${message}</div>`;
      addJournalEntry(journalEntry, 'choice');

      // 3ì´ˆ í›„ í•´ë‹¹ ì—”ë”© í˜ì´ì§€ë¡œ ì´ë™
      setTimeout(() => {
        switch(choice) {
          case 'accept':
            window.location.href = "../endings/happy_ending.html";
            break;
          case 'reject':
            window.location.href = "../endings/bad_ending.html";
            break;
          case 'revenge':
            window.location.href = "../endings/true_ending.html";
            break;
        }
      }, 4000);
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', () => {
      // ì¼ë°˜ ì•„ì´í…œë§Œ ì´ˆê¸°í™” (ì¤‘ìš” ì•„ì´í…œì€ ìœ ì§€)
      if (window.inventory) {
        window.inventory.clearNormalInventory();
      }
      
      // ë³µìˆ˜ ì—”ë”© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
      checkRevengeAvailability();
      
      addJournalEntry('ìˆ˜ìˆ ì‹¤ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. ìµœì¢…ì ì¸ ì„ íƒì˜ ìˆœê°„ì´ ë‹¤ê°€ì™”ìŠµë‹ˆë‹¤.', 'observation');
    });
  </script>
</body>
</html>
